CKEDITOR.dialog.add("symbol",function(l){function r(a,b,c){if(null!=a){for(var w=CKEDITOR.tools.getNextId()+"_symbol_table_label",k=[""],h=0,d=0,l=!1,f,g,m=a.split(","),n=0;n<m.length;n++){f=0;a=-1;g=!1;var e=m[n].split("-");switch(e.length){case 0:break;case 1:"*"==e[0].charAt(e[0].length-1)?(a=f=parseInt(e[0].substring(0,e[0].length-1),16),g=!0):a=f=parseInt(e[0],16);break;default:("*"==e[0].charAt(e[0].length-1)?(f=parseInt(e[0].substring(0,e[0].length-1),16),g=!0):f=parseInt(e[0],16),"*"==e[1].charAt(e[1].length-
1))?(a=parseInt(e[1].substring(0,e[1].length-1),16),g=!0):a=parseInt(e[1],16)}h+=a-f+1;if(a>=f)for(l||(k.push('\x3ctable role\x3d"listbox" aria-labelledby\x3d"'+w+'" style\x3d"width: 100%; height: 100%; border-collapse: separate;" align\x3d"center" cellspacing\x3d"2" cellpadding\x3d"2" border\x3d"0"\x3e'),l=!0);f<=a;){0==d&&k.push("\x3ctr\x3e");for(var e=!0,q=d;q<c;q++,f++)if(f<=a){var r=x(f),t=u&&u[f]||r,v="cke_symbol_label_"+f+"_"+CKEDITOR.tools.getNextNumber();k.push('\x3ctd class\x3d"cke_dark_background" style\x3d"cursor: default" role\x3d"presentation"\x3e\x3ca href\x3d"javascript: void(0);" role\x3d"option" aria-posinset\x3d"'+
(f+1)+'"',' aria-setsize\x3d"'+h+'"',' aria-labelledby\x3d"'+v+'"',' style\x3d"cursor: inherit; display: block; height: 1.25em; margin-top: 0.25em; text-align: center;" title\x3d"',CKEDITOR.tools.htmlEncode(t),'" onkeydown\x3d"CKEDITOR.tools.callFunction( '+y+', event, this )" onclick\x3d"CKEDITOR.tools.callFunction('+z+', this); return false;" tabindex\x3d"-1"\x3e\x3cspan style\x3d"margin: 0 auto;cursor: inherit"'+(g?"\x3e"+p:"\x3e")+r+'\x3c/span\x3e\x3cspan class\x3d"cke_voice_label" id\x3d"'+v+
'"\x3e'+t+"\x3c/span\x3e\x3c/a\x3e");k.push("\x3c/td\x3e")}else{d=q;e=!1;break}if(e)d=0,k.push("\x3c/tr\x3e");else break}}if(0!=d){for(f=d;f<c;f++)k.push("\x3ctd\x3e\x26nbsp;\x3c/td\x3e");k.push("\x3c/tr\x3e")}l?(k[0]=255<h?'\x3cdiv style\x3d"width:100%;height:300px;overflow:auto;"\x3e':"\x3cdiv\x3e",k.push("\x3c/table\x3e\x3c/div\x3e"),c=k.join(""),b.getElement().setHtml(c)):b.getElement().setHtml("\x3cdiv\x3eNo valid range(s) defined...\x3c/div\x3e")}else b.getElement().setHtml("\x3cdiv\x3eNo range defined...\x3c/div\x3e")}
function x(a){a=a.toString(16).toUpperCase();return 1>a.length?eval('"\\u0000"'):2>a.length?eval('"\\u000'+a+'"'):3>a.length?eval('"\\u00'+a+'"'):4>a.length?eval('"\\u0'+a+'"'):eval('"\\u'+a+'"')}function A(a,b){return a[0]==b[0]?0:a[0]>b[0]?1:-1}var p="\x26nbsp;",q=null,d,u=l.lang.symbol,m=null,t=function(a){var b;a=a.data?a.data.getTarget():new CKEDITOR.dom.element(a);"a"==a.getName()&&(b=a.getChild(0).getHtml())&&(a.removeClass("cke_light_background"),b.length>p.length&&0==b.indexOf(p)&&(b=b.substring(p.length)),
d.hide(),a=l.document.createElement("span"),a.setHtml(b),l.insertText(a.getText()))},z=CKEDITOR.tools.addFunction(t),n,g=function(a,b){var c;b=b||a.data.getTarget();"span"==b.getName()&&(b=b.getParent());if("a"==b.getName()&&(c=b.getChild(0).getHtml())){n&&h(null,n);var g=d.getContentElement("info","unicodePreview").getElement();d.getContentElement("info","charPreview").getElement().setHtml(c);var k=0,k="\x26nbsp;"==c?160:c.length>p.length&&0==c.indexOf(p)?c.charCodeAt(p.length):c.charCodeAt(0);g.setHtml("Unicode (hex): "+
k+" ("+k.toString(16).toUpperCase()+")");b.getParent().addClass("cke_light_background");n=b}},h=function(a,b){b=b||a.data.getTarget();"span"==b.getName()&&(b=b.getParent());"a"==b.getName()&&(d.getContentElement("info","unicodePreview").getElement().setHtml("\x26nbsp;"),d.getContentElement("info","charPreview").getElement().setHtml("\x26nbsp;"),b.getParent().removeClass("cke_light_background"),n=void 0)},y=CKEDITOR.tools.addFunction(function(a){a=new CKEDITOR.dom.event(a);var b=a.getTarget(),c;c=
a.getKeystroke();var d="rtl"==l.lang.dir;switch(c){case 38:if(c=b.getParent().getParent().getPrevious())c=c.getChild([b.getParent().getIndex(),0]),c.focus(),h(null,b),g(null,c);a.preventDefault();break;case 40:(c=b.getParent().getParent().getNext())&&(c=c.getChild([b.getParent().getIndex(),0]))&&1==c.type&&(c.focus(),h(null,b),g(null,c));a.preventDefault();break;case 32:t({data:a});a.preventDefault();break;case d?37:39:case 9:if(c=b.getParent().getNext())c=c.getChild(0),1==c.type?(c.focus(),h(null,
b),g(null,c),a.preventDefault(!0)):h(null,b);else if(c=b.getParent().getParent().getNext())(c=c.getChild([0,0]))&&1==c.type?(c.focus(),h(null,b),g(null,c),a.preventDefault(!0)):h(null,b);break;case d?39:37:case CKEDITOR.SHIFT+9:(c=b.getParent().getPrevious())?(c=c.getChild(0),c.focus(),h(null,b),g(null,c),a.preventDefault(!0)):(c=b.getParent().getParent().getPrevious())?(c=c.getLast().getChild(0),c.focus(),h(null,b),g(null,c),a.preventDefault(!0)):h(null,b)}}),B=[CKEDITOR.dialog.cancelButton],C=l.lang.common.generalTab,
D=l.lang.common.generalTab;l.config.sortSymbolRangesAlphabetically?m||(m=CKEDITOR.config.symbolRanges.slice(),m.sort(A)):m=CKEDITOR.config.symbolRanges;return{title:"Select Symbol",buttons:B,charColumns:16,onShow:function(){var a=this.getContentElement("info","symbolRange").getInputElement().$;console.log("domElement.childNodes.length\x3d"+a.childNodes.length);if(0<a.childNodes.length){var b=null;q||(b="Basic Latin",l.config.defaultSymbolRange&&(b=l.config.defaultSymbolRange),console.log("startRange \x3d "+
b));for(var c=0,d=0;d<a.childNodes.length;d++)if(console.log(d+" domElement.childNodes[i].text \x3d "+a.childNodes[d].text),a.childNodes[d].text==b||a.childNodes[d].value==q){c=d;break}a.selectedIndex=c;console.log("selectedIndex \x3d "+a.selectedIndex);b=this.getContentElement("info","charContainer");r(a.childNodes[c].value,b,this.definition.charColumns)}},contents:[{id:"info",label:C,title:D,padding:0,align:"top",onHide:function(){d&&d.destroy()},elements:[{type:"vbox",align:"top",width:"100%",
children:[{type:"select",id:"symbolRange",width:"100%",items:m,size:1,onChange:function(a){console.log("Range changed:");console.log(a.sender.getValue());q=a.sender.getValue();var b=d.getContentElement("info","charContainer");r(a.sender.getValue(),b,d.definition.charColumns)}},{type:"html",id:"charContainer",html:"",onMouseover:g,onMouseout:h,focus:function(){var a=this.getElement().getElementsByTag("a").getItem(0);setTimeout(function(){a.focus();g(null,a)},0)},onShow:function(){var a=this.getElement().getElementsByTag("a").getItem(0);
null!=a&&setTimeout(function(){a.focus();g(null,a)},0)},onLoad:function(a){d=a.sender}},{type:"hbox",align:"top",width:"100%",children:[{type:"html",html:"\x3cdiv\x3e\x3c/div\x3e"},{type:"html",id:"unicodePreview",className:"cke_dark_background",style:"border:1px solid #eeeeee;font-size:14px;height:20px;width:192px;padding-top:25px;font-family:'Microsoft Sans Serif',Arial,'Arial Unicode',Helvetica,Verdana;text-align:center;",html:"\x3cdiv\x3e\x26nbsp;\x3c/div\x3e"},{type:"html",id:"charPreview",className:"cke_dark_background",
style:"border:1px solid #eeeeee;font-size:28px;height:40px;width:70px;padding-top:9px;font-family:'Microsoft Sans Serif',Arial,'Arial Unicode',Helvetica,Verdana;text-align:center;",html:"\x3cdiv\x3e\x26nbsp;\x3c/div\x3e"}]}]}]}]}});